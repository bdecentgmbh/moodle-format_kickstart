{"version":3,"file":"formatkickstart.min.js","sources":["../src/formatkickstart.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Defines Kicstart javascript.\r\n * @module   format_kickstart/formatkickstart\r\n * @category  Classes - autoloading\r\n * @copyright 2021, bdecent gmbh bdecent.de\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n define(['core/loadingicon', 'core/str', 'core/notification', 'core/config', 'core/ajax'],\r\n    function(Loadingicon, str, notification, Config, Ajax) {\r\n\r\n    /**\r\n     * Controls kicstart javascript.\r\n    */\r\n    var Formatkickstart = function(contextid, courseid) {\r\n        var self = this;\r\n        var useTemplate = document.querySelectorAll(\".templates-block .use-template\");\r\n        self.contextId = contextid;\r\n        self.courseId = courseid;\r\n        if (useTemplate) {\r\n            useTemplate.forEach((element) => {\r\n                element.addEventListener('click', self.templateHandler.bind(this));\r\n            });\r\n        }\r\n    };\r\n\r\n    Formatkickstart.prototype.confirmbutton = \".buttons .singlebutton form button\";\r\n\r\n    Formatkickstart.prototype.loadiconElement = \"#modal-footer span#load-action\";\r\n\r\n    Formatkickstart.prototype.contextId = null;\r\n\r\n    Formatkickstart.prototype.courseId = null;\r\n\r\n    Formatkickstart.prototype.templateHandler = function(event) {\r\n        var self = this;\r\n        event.preventDefault();\r\n        let templateName = event.target.getAttribute(\"data-templatename\");\r\n        let templateId = event.target.getAttribute(\"data-template\");\r\n        self.confirmImportTemplate(templateId, templateName);\r\n    };\r\n\r\n    Formatkickstart.prototype.confirmImportTemplate = function(templateId, templateName) {\r\n        let self = this;\r\n        var plugindata = {\r\n            name: templateName\r\n        };\r\n        str.get_strings([\r\n            {key: 'confirm', component: 'core'},\r\n            {key: 'confirmtemplate', param: plugindata, component: 'format_kickstart'},\r\n            {key: 'import'},\r\n            {key: 'no'}\r\n        ]).done(function(s) {\r\n                notification.confirm(s[0], s[1], s[2], s[3], function() {\r\n                    document.querySelectorAll(\"body\")[0].classList.add(\"kickstart-icon\");\r\n                    Ajax.call([{\r\n                        methodname: 'format_kickstart_import_template',\r\n                        args: {templateid: templateId, courseid: self.courseId},\r\n                        done: function(response) {\r\n                            if (response) {\r\n                                let redirect = Config.wwwroot + \"/course/view.php?id=\" + self.courseId;\r\n                                window.location.assign(redirect);\r\n                            }\r\n                        }\r\n                    }]);\r\n                });\r\n            }\r\n        );\r\n    }\r\n\r\n    return {\r\n        init: function(contextid, courseid) {\r\n            return new Formatkickstart(contextid, courseid);\r\n        }\r\n    };\r\n});"],"names":["define","Loadingicon","str","notification","Config","Ajax","Formatkickstart","contextid","courseid","self","this","useTemplate","document","querySelectorAll","contextId","courseId","forEach","element","addEventListener","templateHandler","bind","_this","prototype","confirmbutton","loadiconElement","event","preventDefault","templateName","target","getAttribute","templateId","confirmImportTemplate","plugindata","name","get_strings","key","component","param","done","s","confirm","classList","add","call","methodname","args","templateid","response","redirect","wwwroot","window","location","assign","init"],"mappings":";;;;;;;AAsBCA,0CAAO,CAAC,mBAAoB,WAAY,oBAAqB,cAAe,cACzE,SAASC,YAAaC,IAAKC,aAAcC,OAAQC,UAK7CC,gBAAkB,SAASC,UAAWC,yBAClCC,KAAOC,KACPC,YAAcC,SAASC,iBAAiB,kCAC5CJ,KAAKK,UAAYP,UACjBE,KAAKM,SAAWP,SACZG,aACAA,YAAYK,SAAQ,SAACC,SACjBA,QAAQC,iBAAiB,QAAST,KAAKU,gBAAgBC,KAAKC,mBAKxEf,gBAAgBgB,UAAUC,cAAgB,qCAE1CjB,gBAAgBgB,UAAUE,gBAAkB,iCAE5ClB,gBAAgBgB,UAAUR,UAAY,KAEtCR,gBAAgBgB,UAAUP,SAAW,KAErCT,gBAAgBgB,UAAUH,gBAAkB,SAASM,OAEjDA,MAAMC,qBACFC,aAAeF,MAAMG,OAAOC,aAAa,qBACzCC,WAAaL,MAAMG,OAAOC,aAAa,iBAHhCnB,KAINqB,sBAAsBD,WAAYH,eAG3CrB,gBAAgBgB,UAAUS,sBAAwB,SAASD,WAAYH,kBAC/DlB,KAAOC,KACPsB,WAAa,CACbC,KAAMN,cAEVzB,IAAIgC,YAAY,CACZ,CAACC,IAAK,UAAWC,UAAW,QAC5B,CAACD,IAAK,kBAAmBE,MAAOL,WAAYI,UAAW,oBACvD,CAACD,IAAK,UACN,CAACA,IAAK,QACPG,MAAK,SAASC,GACTpC,aAAaqC,QAAQD,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAI,WACzC3B,SAASC,iBAAiB,QAAQ,GAAG4B,UAAUC,IAAI,kBACnDrC,KAAKsC,KAAK,CAAC,CACPC,WAAY,mCACZC,KAAM,CAACC,WAAYhB,WAAYtB,SAAUC,KAAKM,UAC9CuB,KAAM,SAASS,aACPA,SAAU,KACNC,SAAW5C,OAAO6C,QAAU,uBAAyBxC,KAAKM,SAC9DmC,OAAOC,SAASC,OAAOJ,sBAS5C,CACHK,KAAM,SAAS9C,UAAWC,iBACf,IAAIF,gBAAgBC,UAAWC"}