{"version":3,"file":"formatkickstart.min.js","sources":["../src/formatkickstart.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Defines Kicstart javascript.\n * @module   format_kickstart/formatkickstart\n * @category  Classes - autoloading\n * @copyright 2021, bdecent gmbh bdecent.de\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n define(['core/str', 'core/notification', 'core/config', 'core/ajax'],\n    function(str, notification, Config, Ajax) {\n\n    /**\n     * Controls kicstart javascript.\n     * @param {int} contextid\n     * @param {int} courseid\n     * @return {void}\n    */\n    var Formatkickstart = function(contextid, courseid) {\n        var self = this;\n        var useTemplate = document.querySelectorAll(\".templates-block .use-template\");\n        self.contextId = contextid;\n        self.courseId = courseid;\n        if (useTemplate) {\n            useTemplate.forEach((element) => {\n                element.addEventListener('click', self.templateHandler.bind(this));\n            });\n        }\n    };\n\n    Formatkickstart.prototype.confirmbutton = \".buttons .singlebutton form button\";\n\n    Formatkickstart.prototype.loadiconElement = \"#modal-footer span#load-action\";\n\n    Formatkickstart.prototype.courseId = null;\n\n    Formatkickstart.prototype.contextId = null;\n\n    Formatkickstart.prototype.templateHandler = function(e) {\n        var self = this;\n        e.preventDefault();\n        let templateName = e.target.getAttribute(\"data-templatename\");\n        let templateId = e.target.getAttribute(\"data-template\");\n        self.confirmImportTemplate(templateId, templateName);\n    };\n\n    Formatkickstart.prototype.confirmImportTemplate = function(templateId, templateName) {\n        let self = this;\n        var plugindata = {\n            name: templateName\n        };\n        str.get_strings([\n            {key: 'confirm', component: 'core'},\n            {key: 'confirmtemplate', param: plugindata, component: 'format_kickstart'},\n            {key: 'import'},\n            {key: 'no'}\n        ]).done(function(s) {\n                notification.confirm(s[0], s[1], s[2], s[3], function() {\n                    document.querySelectorAll(\"body\")[0].classList.add(\"kickstart-icon\");\n                    Ajax.call([{\n                        methodname: 'format_kickstart_import_template',\n                        args: {templateid: templateId, courseid: self.courseId},\n                        done: function(response) {\n                            if (response) {\n                                let redirect = Config.wwwroot + \"/course/view.php?id=\" + self.courseId;\n                                window.location.assign(redirect);\n                            }\n                        }\n                    }]);\n                });\n            }\n        );\n    };\n\n    return {\n        init: function(contextid, courseid) {\n            return new Formatkickstart(contextid, courseid);\n        }\n    };\n});"],"names":["define","str","notification","Config","Ajax","Formatkickstart","contextid","courseid","_this","this","self","useTemplate","document","querySelectorAll","contextId","courseId","forEach","element","addEventListener","templateHandler","bind","prototype","confirmbutton","loadiconElement","e","preventDefault","templateName","target","getAttribute","templateId","confirmImportTemplate","plugindata","name","get_strings","key","component","param","done","s","confirm","classList","add","call","methodname","args","templateid","response","redirect","wwwroot","window","location","assign","init"],"mappings":";;;;;;;AAsBCA,0CAAO,CAAC,WAAY,oBAAqB,cAAe,cACrD,SAASC,IAAKC,aAAcC,OAAQC,MAQhCC,IAAAA,gBAAkB,SAASC,UAAWC,UAAU,IAAAC,MAAAC,KAC5CC,KAAOD,KACPE,YAAcC,SAASC,iBAAiB,kCAC5CH,KAAKI,UAAYR,UACjBI,KAAKK,SAAWR,SACZI,aACAA,YAAYK,SAAQ,SAACC,SACjBA,QAAQC,iBAAiB,QAASR,KAAKS,gBAAgBC,KAAKZ,OAC/D,GAER,EA8CM,OA5CPH,gBAAgBgB,UAAUC,cAAgB,qCAE1CjB,gBAAgBgB,UAAUE,gBAAkB,iCAE5ClB,gBAAgBgB,UAAUN,SAAW,KAErCV,gBAAgBgB,UAAUP,UAAY,KAEtCT,gBAAgBgB,UAAUF,gBAAkB,SAASK,GAEjDA,EAAEC,iBACEC,IAAAA,aAAeF,EAAEG,OAAOC,aAAa,qBACrCC,WAAaL,EAAEG,OAAOC,aAAa,iBAH5BnB,KAINqB,sBAAsBD,WAAYH,aAC1C,EAEDrB,gBAAgBgB,UAAUS,sBAAwB,SAASD,WAAYH,cAC/DhB,IAAAA,KAAOD,KACPsB,WAAa,CACbC,KAAMN,cAEVzB,IAAIgC,YAAY,CACZ,CAACC,IAAK,UAAWC,UAAW,QAC5B,CAACD,IAAK,kBAAmBE,MAAOL,WAAYI,UAAW,oBACvD,CAACD,IAAK,UACN,CAACA,IAAK,QACPG,MAAK,SAASC,GACTpC,aAAaqC,QAAQD,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAI,WACzC1B,SAASC,iBAAiB,QAAQ,GAAG2B,UAAUC,IAAI,kBACnDrC,KAAKsC,KAAK,CAAC,CACPC,WAAY,mCACZC,KAAM,CAACC,WAAYhB,WAAYtB,SAAUG,KAAKK,UAC9CsB,KAAM,SAASS,UACX,GAAIA,SAAU,CACNC,IAAAA,SAAW5C,OAAO6C,QAAU,uBAAyBtC,KAAKK,SAC9DkC,OAAOC,SAASC,OAAOJ,SAC1B,CACJ,IAER,GACJ,GAER,EAEM,CACHK,KAAM,SAAS9C,UAAWC,UACtB,OAAO,IAAIF,gBAAgBC,UAAWC,SACzC,EAER"}